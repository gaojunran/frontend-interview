---
title: 	å¦‚ä½•è®¾è®¡ä¸€ä¸ªå‰ç«¯é¡µé¢ï¼Œå®ç° PC ç«¯è®¿é—®å±•ç¤º Web åº”ç”¨ï¼Œç§»åŠ¨ç«¯è®¿é—®å±•ç¤º H5 åº”ç”¨ï¼Ÿ
---

è¦å®ç° **â€œPCç«¯è®¿é—®å±•ç¤º Web åº”ç”¨ï¼Œç§»åŠ¨ç«¯è®¿é—®å±•ç¤º H5 åº”ç”¨â€** çš„å‰ç«¯é¡µé¢è®¾è®¡ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯æ ¹æ®è®¿é—®è®¾å¤‡çš„ç±»å‹ï¼ˆæ¡Œé¢/ç§»åŠ¨ï¼‰**åšå‡ºè‡ªåŠ¨è·³è½¬æˆ–å±•ç¤ºä¸åŒçš„å†…å®¹**ã€‚ä¸‹é¢æ˜¯è¯¦ç»†çš„è®¾è®¡æ€è·¯å’Œå®ç°æ–¹æ¡ˆï¼š

---

## ğŸ§  ä¸€ã€æ•´ä½“æ€è·¯

ä½ æœ‰ä¸¤ä¸ªç‰ˆæœ¬çš„å‰ç«¯é¡¹ç›®ï¼š

* **Web åº”ç”¨**ï¼šä¸º PC ç«¯è®¾è®¡ï¼Œè·¯ç”±å¦‚ `https://example.com/`
* **H5 åº”ç”¨**ï¼šä¸ºç§»åŠ¨ç«¯è®¾è®¡ï¼Œè·¯ç”±å¦‚ `https://m.example.com/` æˆ– `https://example.com/mobile/`

æ ¸å¿ƒé€»è¾‘ï¼š

* **åœ¨å…¥å£å¤„æ£€æµ‹å®¢æˆ·ç«¯ç±»å‹**
* **æ ¹æ®ç»“æœè·³è½¬åˆ°å¯¹åº”çš„ç‰ˆæœ¬**
* å¯åŠ ç™½åå•ã€é»‘åå•ã€UAæ ‡è¯†ã€URLå‚æ•°æ§åˆ¶

---

## ğŸ—ï¸ äºŒã€æ¶æ„è®¾è®¡å›¾ï¼ˆç®€åŒ–ï¼‰

```text
                      +--------------------+
                      | è®¿é—®ä¸»å…¥å£ (index) |
                      +--------------------+
                                 |
                 +---------------+----------------+
                 |                                |
          æ˜¯ç§»åŠ¨è®¾å¤‡?                         å¦ï¼ˆPCç«¯ï¼‰
                 |                                |
     è·³è½¬åˆ° H5 ç«™ç‚¹ï¼ˆm.xxx.comï¼‰            æ¸²æŸ“ Web åº”ç”¨
```

---

## ğŸ› ï¸ ä¸‰ã€å®ç°æ–¹æ¡ˆ

### âœ… æ–¹æ³• 1ï¼šä½¿ç”¨ `User-Agent` è¿›è¡Œè·³è½¬ï¼ˆæ¨èï¼‰

åœ¨ Web åº”ç”¨é¦–é¡µï¼ˆæˆ–ç»Ÿä¸€å…¥å£é¡µï¼‰åŠ ä¸€æ®µè„šæœ¬æ£€æµ‹ UA å¹¶è·³è½¬ï¼š

```js
(function () {
  const ua = navigator.userAgent.toLowerCase();
  const isMobile = /android|iphone|ipad|ipod|mobile/i.test(ua);

  if (isMobile) {
    // è·³è½¬åˆ° H5 é¡µé¢
    window.location.href = 'https://m.example.com';
  } else {
    // ç»§ç»­åŠ è½½å½“å‰é¡µé¢ï¼ˆPCï¼‰
  }
})();
```

> âœ… æ”¾åœ¨ `<head>` çš„ `<script>` æ ‡ç­¾å†…ï¼Œç¡®ä¿è¶Šæ—©æ‰§è¡Œè¶Šå¥½ã€‚

---

### âœ… æ–¹æ³• 2ï¼šNginx é…ç½®å±‚åˆ¤æ–­ UAï¼ˆæ›´å¼ºæ§åˆ¶ï¼‰

å¦‚æœä½ æœ‰éƒ¨ç½²åœ¨ Nginx ä¸Šï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨å±‚åˆ¤æ–­ UAï¼Œè‡ªåŠ¨é‡å®šå‘ï¼š

```nginx
server {
  listen 80;
  server_name example.com;

  if ($http_user_agent ~* "(iphone|android|ipad|mobile)") {
      return 301 https://m.example.com$request_uri;
  }

  location / {
    proxy_pass http://pc_web_app;
  }
}
```

---

### âœ… æ–¹æ³• 3ï¼šä½¿ç”¨å­åŸŸå+ç‹¬ç«‹é¡¹ç›®

è¿™ç§æ–¹å¼å»ºè®®ä½¿ç”¨ **ä¸¤ä¸ªç‹¬ç«‹éƒ¨ç½²çš„å‰ç«¯é¡¹ç›®**ï¼š

| é¡¹ç›®  | è·¯ç”±                                   | è¯´æ˜       |
| --- | ------------------------------------ | -------- |
| Web | `https://www.example.com`            | PC æµè§ˆå™¨è®¿é—® |
| H5  | `https://m.example.com` æˆ– `/mobile/` | ç§»åŠ¨ç«¯è®¿é—®    |

å„è‡ªæœ‰ç‹¬ç«‹æ„å»ºã€æ‰“åŒ…ã€éƒ¨ç½²ï¼Œé¿å…é€‚é…æˆæœ¬ã€‚

---

### âœ… æ–¹æ³• 4ï¼šå“åº”å¼æ–¹æ¡ˆï¼ˆå•é¡¹ç›®ï¼‰

ä½¿ç”¨åª’ä½“æŸ¥è¯¢æˆ– Vue + Vant æ¥å®ç°å“åº”å¼å¸ƒå±€ï¼Œ**ä½†ç¼ºç‚¹æ˜¯ PC ç«¯è¦åŠ è½½ç§»åŠ¨ç«¯ä»£ç ï¼Œæ–‡ä»¶ä½“ç§¯è¾ƒå¤§**ã€‚æ­¤æ–¹å¼æ˜¯â€œåˆå¹¶é¡¹ç›®â€çš„æ–¹å¼ã€‚

åª’ä½“æŸ¥è¯¢ç¤ºä¾‹ï¼š

```css
/* PC */
@media screen and (min-width: 1025px) {
  .container {
    width: 80%;
  }
}

/* Mobile */
@media screen and (max-width: 768px) {
  .container {
    width: 100%;
    font-size: 14px;
  }
}
```

---

## ğŸ§© å››ã€ä¼˜åŒ–å»ºè®®

### 1. â— åŠ ä¸Š URL å‚æ•°ç»•è¿‡è·³è½¬ï¼ˆè°ƒè¯•ç”¨ï¼‰

```js
const url = new URL(window.location.href);
if (url.searchParams.get("force") === "pc") {
  return;
}
```

### 2. âœ… ç”¨ Vue Router æˆ– React Router åœ¨å…¥å£åˆ¤æ–­è·³è½¬ï¼ˆå•é¡µåº”ç”¨ï¼‰

åœ¨å‰ç«¯è·¯ç”±æ–‡ä»¶ä¸­åšè·³è½¬ï¼š

```js
router.beforeEach((to, from, next) => {
  const ua = navigator.userAgent.toLowerCase();
  const isMobile = /android|iphone|ipad|ipod|mobile/i.test(ua);
  if (isMobile && location.hostname !== 'm.example.com') {
    window.location.href = 'https://m.example.com';
  } else {
    next();
  }
});
```

---

## âœ… æ€»ç»“

| æ–¹æ³•          | æè¿°                                               | ä¼˜ç‚¹        | ç¼ºç‚¹           |
| ----------- | ------------------------------------------------ | --------- | ------------ |
| JS UA æ£€æµ‹è·³è½¬  | å‰ç«¯é€»è¾‘å®ç°                                           | ç®€å•ï¼Œçµæ´»     | é¦–æ¬¡åŠ è½½æµªè´¹ä¸€ç‚¹èµ„æº   |
| Nginx æ£€æµ‹ UA | æœåŠ¡å™¨å±‚è·³è½¬                                           | å¿«é€Ÿã€æ— å‰ç«¯æŸè€—  | éœ€æœåŠ¡ç«¯æ”¯æŒé…ç½®     |
| å­åŸŸåéƒ¨ç½²       | m.xxx.com å’Œ [www.xxx.com](http://www.xxx.com) åˆ†å¼€ | é¡¹ç›®ç‹¬ç«‹ï¼Œéƒ¨ç½²æ–¹ä¾¿ | ç»´æŠ¤ä¸¤å¥—ä»£ç        |
| å“åº”å¼è®¾è®¡       | å•é¡¹ç›®å¤šç»ˆç«¯                                           | ç®¡ç†æ–¹ä¾¿      | æ–‡ä»¶ä½“ç§¯å¤§ï¼Œäº¤äº’å¤æ‚åº¦é«˜ |


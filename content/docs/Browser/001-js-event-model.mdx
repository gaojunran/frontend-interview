---
title: è¯´è¯´JavaScriptä¸­çš„äº‹ä»¶æ¨¡å‹ï¼Ÿ
---

JavaScript ä¸­çš„äº‹ä»¶æ¨¡å‹æ˜¯å‰ç«¯å¼€å‘ä¸­éå¸¸é‡è¦çš„æ¦‚å¿µä¹‹ä¸€ï¼Œä¸»è¦ç”¨äºå¤„ç†ç”¨æˆ·ä¸é¡µé¢çš„äº¤äº’è¡Œä¸ºã€‚äº‹ä»¶æ¨¡å‹æ¶‰åŠä¸‰ä¸ªæ ¸å¿ƒæœºåˆ¶ï¼š

---

## ä¸€ã€JavaScriptäº‹ä»¶æ¨¡å‹çš„ä¸‰ç§ç±»å‹

### 1. äº‹ä»¶å†’æ³¡ï¼ˆEvent Bubblingï¼‰

* é»˜è®¤çš„äº‹ä»¶ä¼ æ’­æ–¹å¼ã€‚
* **äº‹ä»¶ä»æœ€å…·ä½“çš„å…ƒç´ ï¼ˆäº‹ä»¶ç›®æ ‡ï¼‰å¼€å§‹å‘ç”Ÿï¼Œç„¶åå‘ä¸Šä¼ æ’­åˆ°ç¥–å…ˆå…ƒç´ ï¼Œç›´åˆ° `document`ã€‚**
* ä¸¾ä¾‹ï¼šç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼Œäº‹ä»¶ä¼šå…ˆåœ¨æŒ‰é’®ä¸Šè§¦å‘ï¼Œç„¶åä¾æ¬¡å†’æ³¡åˆ°å…¶çˆ¶çº§ã€ç¥–çˆ¶çº§ç­‰ã€‚

```javascript
document.getElementById('child').addEventListener('click', () => {
  console.log('child clicked');
});
document.getElementById('parent').addEventListener('click', () => {
  console.log('parent clicked');
});
// ç‚¹å‡» child ä¼šä¾æ¬¡è¾“å‡ºï¼š
// child clicked
// parent clicked
```

---

### 2. äº‹ä»¶æ•è·ï¼ˆEvent Capturingï¼‰

* å¦ä¸€ç§è¾ƒå°‘ä½¿ç”¨çš„äº‹ä»¶ä¼ æ’­æ–¹å¼ã€‚
* **äº‹ä»¶ä»é¡¶å±‚å…ƒç´ å‘ç›®æ ‡å…ƒç´ ä¼ é€’ï¼ˆä»å¤–åˆ°å†…ï¼‰ã€‚**
* ä½¿ç”¨ `addEventListener(type, listener, **true**)` æŒ‡å®šåœ¨æ•è·é˜¶æ®µæ‰§è¡Œã€‚

```javascript
document.getElementById('parent').addEventListener(
  'click',
  () => {
    console.log('parent capture');
  },
  true
);
```

---

### 3. ç›®æ ‡é˜¶æ®µï¼ˆTarget Phaseï¼‰

* **äº‹ä»¶åˆ°è¾¾ç›®æ ‡å…ƒç´ å¹¶åœ¨è¯¥å…ƒç´ ä¸Šè§¦å‘çš„é˜¶æ®µã€‚**
* åœ¨å†’æ³¡æˆ–æ•è·è¿‡ç¨‹ä¸­ï¼Œäº‹ä»¶éƒ½ä¼šåœ¨ç›®æ ‡å…ƒç´ ä¸Šè§¦å‘ä¸€æ¬¡ã€‚

---

## äºŒã€äº‹ä»¶æ¨¡å‹çš„ä¸‰ä¸ªé˜¶æ®µ

> JavaScript DOM Level 2 äº‹ä»¶æ¨¡å‹è§„èŒƒä¸­ï¼Œäº‹ä»¶çš„ä¼ æ’­å…±åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š

1. **æ•è·é˜¶æ®µ**ï¼ˆCapturing Phaseï¼‰
2. **ç›®æ ‡é˜¶æ®µ**ï¼ˆTarget Phaseï¼‰
3. **å†’æ³¡é˜¶æ®µ**ï¼ˆBubbling Phaseï¼‰

ğŸ“Œ é»˜è®¤æƒ…å†µä¸‹ï¼Œäº‹ä»¶ç›‘å¬å™¨ç»‘å®šåœ¨ **å†’æ³¡é˜¶æ®µ**ï¼Œé™¤é `addEventListener` çš„ç¬¬ä¸‰ä¸ªå‚æ•°è®¾ä¸º `true`ã€‚

---

## ä¸‰ã€äº‹ä»¶å§”æ‰˜ï¼ˆäº‹ä»¶ä»£ç†ï¼‰

äº‹ä»¶å§”æ‰˜æ˜¯ä¸€ç§åŸºäº**äº‹ä»¶å†’æ³¡**æœºåˆ¶çš„ä¼˜åŒ–æŠ€å·§ï¼Œç”¨äºæé«˜æ€§èƒ½æˆ–å¤„ç†åŠ¨æ€ç”Ÿæˆçš„å…ƒç´ äº‹ä»¶ã€‚

```javascript
document.getElementById('list').addEventListener('click', (e) => {
  if (e.target.tagName === 'LI') {
    console.log('ç‚¹å‡»äº†æŸä¸ªåˆ—è¡¨é¡¹');
  }
});
```

ä¼˜ç‚¹ï¼š

* å‡å°‘äº‹ä»¶å¤„ç†å‡½æ•°çš„ç»‘å®šæ•°é‡
* ä¾¿äºå¤„ç†åŠ¨æ€æ·»åŠ çš„ DOM å…ƒç´ 

---

## å››ã€äº‹ä»¶å¯¹è±¡ï¼ˆEvent Objectï¼‰

å½“äº‹ä»¶è§¦å‘æ—¶ï¼Œä¼šä¼ é€’ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ `event`ï¼ŒåŒ…å«å½“å‰äº‹ä»¶çš„å„ç§ä¿¡æ¯ï¼š

* `event.target`: è§¦å‘äº‹ä»¶çš„çœŸå®å…ƒç´ 
* `event.currentTarget`: å½“å‰ç»‘å®šäº‹ä»¶å¤„ç†å™¨çš„å…ƒç´ 
* `event.type`: äº‹ä»¶ç±»å‹ï¼ˆå¦‚ "click"ï¼‰
* `event.stopPropagation()`: é˜»æ­¢äº‹ä»¶ç»§ç»­å†’æ³¡/æ•è·
* `event.preventDefault()`: é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼ˆå¦‚è¡¨å•æäº¤ï¼‰

---

## äº”ã€å¸¸è§äº‹ä»¶ç±»å‹

* é¼ æ ‡äº‹ä»¶ï¼š`click`ã€`dblclick`ã€`mouseover`ã€`mouseout`ã€`mousemove`
* é”®ç›˜äº‹ä»¶ï¼š`keydown`ã€`keyup`
* è¡¨å•äº‹ä»¶ï¼š`submit`ã€`change`ã€`focus`ã€`blur`
* è§¦æ‘¸äº‹ä»¶ï¼š`touchstart`ã€`touchmove`ã€`touchend`
* å…¶ä»–ï¼š`load`ã€`resize`ã€`scroll`

---

## å…­ã€äº‹ä»¶ç»‘å®šæ–¹å¼

1. HTMLå±æ€§ç»‘å®šï¼ˆä¸æ¨èï¼‰ï¼š

```html
<button onclick="alert('clicked')">Click me</button>
```

2. DOM 0 çº§ç»‘å®šï¼ˆè¦†ç›–å¼ï¼‰ï¼š

```javascript
element.onclick = function () {};
```

3. DOM 2 çº§ç»‘å®šï¼ˆæ¨èï¼‰ï¼š

```javascript
element.addEventListener('click', function () {}, false); // false ä¸ºé»˜è®¤å†’æ³¡é˜¶æ®µ
```

---

## ä¸ƒã€æ€»ç»“ï¼šäº‹ä»¶æ¨¡å‹é‡ç‚¹è®°å¿†

| é˜¶æ®µ   | æè¿°                 | æ§åˆ¶æ–¹å¼          |
| ---- | ------------------ | ------------- |
| æ•è·é˜¶æ®µ | ä» document å‘ä¸‹ä¼ æ’­åˆ°ç›®æ ‡ | ç¬¬ä¸‰å‚æ•°è®¾ä¸º `true` |
| ç›®æ ‡é˜¶æ®µ | äº‹ä»¶åœ¨ç›®æ ‡å…ƒç´ ä¸Šè§¦å‘         | é»˜è®¤æ‰§è¡Œ          |
| å†’æ³¡é˜¶æ®µ | ä»ç›®æ ‡å…ƒç´ å‘ä¸Šä¼ æ’­          | é»˜è®¤è¡Œä¸º          |

---


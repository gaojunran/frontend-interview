---
title: TypeScript å†…å»ºå·¥å…· NonNull, NoInfer, ThisParameterType, OmitThisParameter, ThisType æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ
---

åœ¨ TypeScript ä¸­ï¼Œå†…å»ºå·¥å…·ç±»å‹ï¼ˆutility typesï¼‰å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç±»å‹ç³»ç»Ÿä¸­è¿›è¡Œå¤æ‚çš„å˜æ¢å’Œçº¦æŸã€‚ä½ æåˆ°çš„è¿™å‡ ä¸ªå·¥å…·ç±»å‹ï¼š

* `NonNullable<T>`
* `NoInfer<T>`
* `ThisParameterType<T>`
* `OmitThisParameter<T>`
* `ThisType<T>`

å®ƒä»¬åˆ†åˆ«ç”¨äºä¸åŒåœºæ™¯ã€‚ä¸‹é¢æˆ‘æ¥è¯¦ç»†è®²è®²å®ƒä»¬çš„ **ä½œç”¨ã€ä½¿ç”¨åœºæ™¯å’Œä¾‹å­**ã€‚

---

## 1. `NonNullable<T>`

### âœ… ä½œç”¨ï¼š

ä» `T` ç±»å‹ä¸­æ’é™¤ `null` å’Œ `undefined`ã€‚

### ğŸ“Œ è¯­æ³•ï¼š

```ts
type NonNullable<T> = T extends null | undefined ? never : T;
```

### ğŸ“˜ ç¤ºä¾‹ï¼š

```ts
type A = string | null | undefined;
type B = NonNullable<A>; // ç»“æœ: string
```

### âœ… ä½¿ç”¨åœºæ™¯ï¼š

åœ¨å‡½æ•°æˆ–å¯¹è±¡å±æ€§ä¸­ï¼Œæˆ‘ä»¬æƒ³ç¡®ä¿å€¼ä¸ä¼šæ˜¯ `null` æˆ– `undefined`ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå·¥å…·ç±»å‹ã€‚

---

## 2. `NoInfer<T>`ï¼ˆä¸æ˜¯å®˜æ–¹å…¬å¼€ APIï¼Œä½†ç»å¸¸ç”¨äºæŠ€å·§ï¼‰

### âœ… ä½œç”¨ï¼š

**é˜»æ­¢ç±»å‹å‚æ•°è¢«ç±»å‹æ¨å¯¼**ï¼Œå¼ºåˆ¶ä½¿ç”¨è°ƒç”¨æ—¶æä¾›çš„ç±»å‹ã€‚

> å®ƒä¸æ˜¯ TypeScript å®˜æ–¹æä¾›çš„å·¥å…·ç±»å‹ï¼Œä½†å¯ä»¥é€šè¿‡ç±»å‹æŠ€å·§å®ç°å¦‚ä¸‹ï¼š

### ğŸ“Œ å®ç°æ–¹å¼ï¼ˆæŠ€å·§ï¼‰ï¼š

```ts
type NoInfer<T> = [T][T extends any ? 0 : never];
```

### ğŸ“˜ ç¤ºä¾‹ï¼š

```ts
function processValue<T>(value: T, defaultValue: NoInfer<T>): T {
  return value ?? defaultValue;
}

processValue<string | undefined>(undefined, "hello"); // defaultValue å¿…é¡»æ˜¯ string | undefined
```

å¦‚æœæ²¡æœ‰ `NoInfer`ï¼Œ`defaultValue` å¯èƒ½ä¼šè¢«æ¨å¯¼ä¸º `string`ï¼Œä½¿æ³›å‹ç±»å‹å¤±æ•ˆã€‚

### âœ… ä½¿ç”¨åœºæ™¯ï¼š

ç”¨äºå‡½æ•°ä¸­å¤šä¸ªå‚æ•°å…±äº«ä¸€ä¸ªç±»å‹ `T`ï¼Œä½†ä½ ä¸æƒ³è®©ç¬¬äºŒä¸ªå‚æ•°å½±å“ç±»å‹æ¨å¯¼ç»“æœã€‚

---

## 3. `ThisParameterType<T>`

### âœ… ä½œç”¨ï¼š

æå–å‡½æ•°ç±»å‹ä¸­ `this` çš„ç±»å‹ã€‚

### ğŸ“Œ è¯­æ³•ï¼š

```ts
type ThisParameterType<T> = T extends (this: infer U, ...args: any) => any ? U : unknown;
```

### ğŸ“˜ ç¤ºä¾‹ï¼š

```ts
function say(this: { name: string }) {
  console.log(this.name);
}

type This = ThisParameterType<typeof say>; 
// ç»“æœ: { name: string }
```

### âœ… ä½¿ç”¨åœºæ™¯ï¼š

ç”¨äºç»„åˆå‡½æ•°ç»‘å®šä¸Šä¸‹æ–‡ï¼Œæ¯”å¦‚ `bind` çš„ç±»å‹æ¨å¯¼ã€‚

---

## 4. `OmitThisParameter<T>`

### âœ… ä½œç”¨ï¼š

ä»å‡½æ•°ç±»å‹ä¸­ç§»é™¤ `this` å‚æ•°ã€‚

### ğŸ“Œ è¯­æ³•ï¼š

```ts
type OmitThisParameter<T> = unknown extends ThisParameterType<T> ? T : T extends (...args: infer A) => infer R ? (...args: A) => R : T;
```

### ğŸ“˜ ç¤ºä¾‹ï¼š

```ts
function say(this: { name: string }) {
  console.log(this.name);
}

const bound: OmitThisParameter<typeof say> = say.bind({ name: 'Tom' });
bound(); // OK
```

### âœ… ä½¿ç”¨åœºæ™¯ï¼š

å½“ä½ æƒ³æŠŠä¸€ä¸ªæœ‰ `this` çš„å‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªæ™®é€šå‡½æ•°å˜é‡ï¼ˆæ¯”å¦‚ `bind` ä¹‹åçš„å‡½æ•°ï¼‰ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå·¥å…·ç±»å‹ã€‚

---

## 5. `ThisType<T>`

### âœ… ä½œç”¨ï¼š

ç”¨äº**å¯¹è±¡å­—é¢é‡ä¸­å£°æ˜ `this` ç±»å‹**ï¼Œä¸»è¦ç”¨äºä¸Šä¸‹æ–‡æ¨å¯¼ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„ç±»å‹æ£€æŸ¥ã€‚

> å®ƒä¸æ”¹å˜å¯¹è±¡æœ¬èº«çš„ç»“æ„ï¼Œä»…å½±å“ TypeScript åœ¨å¯¹è±¡å†…éƒ¨æ¨å¯¼ `this` çš„ç±»å‹ã€‚

### ğŸ“Œ ç¤ºä¾‹ï¼š

```ts
type ObjectDescriptor<D, M> = {
  data?: D;
  methods?: M & ThisType<D & M>; // è®¾ç½® this çš„ç±»å‹ä¸º D & M
};

function makeObject<D, M>(desc: ObjectDescriptor<D, M>): D & M {
  const data: object = desc.data || {};
  const methods: object = desc.methods || {};
  return Object.assign({}, data, methods);
}

const obj = makeObject({
  data: { x: 0, y: 0 },
  methods: {
    moveBy(dx: number, dy: number) {
      this.x += dx; // âœ… è‡ªåŠ¨æ¨æ–­ this.x å’Œ this.y
      this.y += dy;
    },
  },
});
```

### âœ… ä½¿ç”¨åœºæ™¯ï¼š

ç”¨äº Vue 2 Options API ä¸­å£°æ˜ `this`ï¼Œæˆ–å…¶ä»–åŸºäºå¯¹è±¡é…ç½®é£æ ¼çš„ APIã€‚

---

## æ€»ç»“å¯¹æ¯”

| å·¥å…·ç±»å‹                   | ä½œç”¨                       | ä¸»è¦ä½¿ç”¨åœºæ™¯                        |
| ---------------------- | ------------------------ | ----------------------------- |
| `NonNullable<T>`       | å»é™¤ `null` å’Œ `undefined`  | ä¿è¯å€¼ä¸ä¸º `null/undefined`        |
| `NoInfer<T>`           | é˜»æ­¢ç±»å‹æ¨å¯¼                   | ç²¾ç¡®æ§åˆ¶ç±»å‹å‚æ•°ï¼Œé˜²æ­¢è¢«æ¨å¯¼è¦†ç›–              |
| `ThisParameterType<T>` | è·å–å‡½æ•°çš„ `this` ç±»å‹          | ç¼–å†™ `bind` ç­‰å·¥å…·å‡½æ•°               |
| `OmitThisParameter<T>` | ç§»é™¤å‡½æ•°çš„ `this` å‚æ•°          | å°†æœ‰ `this` çš„å‡½æ•°è½¬ä¸ºæ™®é€šå‡½æ•°           |
| `ThisType<T>`          | ä¸ºå¯¹è±¡è®¾ç½® `this` ç±»å‹æ¨å¯¼ï¼ˆéç±»å‹å£°æ˜ï¼‰ | å¯¹è±¡é…ç½®é£æ ¼ APIï¼Œæ¯”å¦‚ Vue Options API |

---

å¦‚æœä½ æƒ³äº†è§£è¿™äº›å·¥å…·ç±»å‹çš„åº•å±‚å®ç°ï¼Œæˆ–çœ‹çœ‹ä¸€äº›ç»„åˆç”¨æ³•ï¼ˆæ¯”å¦‚ `NoInfer` + æ³›å‹å‡½æ•°ç»„åˆä¼˜åŒ–å‚æ•°æç¤ºï¼‰ï¼Œä¹Ÿå¯ä»¥ç»§ç»­é—®æˆ‘ã€‚

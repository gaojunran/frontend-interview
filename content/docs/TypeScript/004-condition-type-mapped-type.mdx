---
title: ä»€ä¹ˆæ˜¯ TypeScript é‡Œçš„æ¡ä»¶ç±»å‹ã€æ˜ å°„ç±»å‹ï¼Ÿ
---

åœ¨ TypeScript ä¸­ï¼Œ\*\*æ¡ä»¶ç±»å‹ï¼ˆConditional Typesï¼‰**å’Œ**æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰\*\*æ˜¯å¼ºå¤§çš„ç±»å‹å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ ç¼–å†™æ›´çµæ´»ã€æ›´å…·è¡¨è¾¾åŠ›çš„ç±»å‹é€»è¾‘ã€‚ä¸‹é¢æˆ‘å°†åˆ†åˆ«è¯¦ç»†ä»‹ç»è¿™ä¸¤è€…ï¼Œå¹¶é€šè¿‡ç¤ºä¾‹åŠ æ·±ç†è§£ã€‚

---

## ğŸ§© ä¸€ã€æ¡ä»¶ç±»å‹ï¼ˆConditional Typesï¼‰

### 1. æ¦‚å¿µ

æ¡ä»¶ç±»å‹å…è®¸æ ¹æ®ç±»å‹ä¹‹é—´çš„\*\*å…³ç³»ï¼ˆextendsï¼‰\*\*æ¥è¿›è¡Œåˆ¤æ–­ï¼Œä»è€Œè¿”å›ä¸åŒçš„ç±»å‹ç»“æœã€‚

```ts
T extends U ? X : Y
```

è§£é‡Šï¼š

* å¦‚æœ `T` æ˜¯ `U` çš„å­ç±»å‹ï¼Œåˆ™è¿”å›ç±»å‹ `X`ï¼Œå¦åˆ™è¿”å›ç±»å‹ `Y`ã€‚

### 2. ç¤ºä¾‹

```ts
type IsString<T> = T extends string ? true : false;

type A = IsString<'hello'>; // true
type B = IsString<123>;     // false
```

### 3. è”åˆç±»å‹åˆ†å‘ç‰¹æ€§ï¼ˆDistributive Conditional Typesï¼‰

```ts
type ToArray<T> = T extends any ? T[] : never;

type A = ToArray<string>;      // string[]
type B = ToArray<string | number>; // string[] | number[]
```

è§£é‡Šï¼šæ¡ä»¶ç±»å‹åœ¨å¤„ç†è”åˆç±»å‹æ—¶ä¼šã€Œè‡ªåŠ¨åˆ†å‘ã€ï¼Œå³å¯¹è”åˆçš„æ¯ä¸ªæˆå‘˜éƒ½å•ç‹¬è®¡ç®—ä¸€æ¬¡ã€‚

#### å¦‚æœä¸æƒ³åˆ†å‘è”åˆç±»å‹

```ts
type NoDistrib<T> = [T] extends [any] ? T[] : never;

type C = NoDistrib<string | number>; // (string | number)[]
```

---

## ğŸ§± äºŒã€æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰

### 1. æ¦‚å¿µ

æ˜ å°„ç±»å‹ç”¨äº**éå†å·²æœ‰ç±»å‹çš„é”®ï¼ˆkeyï¼‰å¹¶ç”Ÿæˆæ–°ç±»å‹**ã€‚

è¯­æ³•æ ¼å¼ï¼š

```ts
type MyMapped<T> = {
  [P in keyof T]: SomeType
}
```

### 2. ç¤ºä¾‹

```ts
type Person = {
  name: string;
  age: number;
};

type ReadonlyPerson = {
  [P in keyof Person]: Readonly<Person[P]>;
};
// ç›¸å½“äºï¼š
/*
type ReadonlyPerson = {
  name: Readonly<string>;
  age: Readonly<number>;
}
*/
```

æ›´å¸¸è§çš„å½¢å¼æ˜¯å°†å€¼ä¿æŒä¸å˜ï¼Œä»…ä¿®é¥°å±æ€§ï¼š

```ts
type Readonly<T> = {
  readonly [P in keyof T]: T[P];
};

type Partial<T> = {
  [P in keyof T]?: T[P];
};
```

### 3. ç»“åˆæ¡ä»¶ç±»å‹

```ts
type NullableProps<T> = {
  [P in keyof T]: T[P] extends string ? string | null : T[P];
};

type Example = {
  name: string;
  age: number;
};

type Result = NullableProps<Example>;
// => {
//   name: string | null;
//   age: number;
// }
```

---

## ğŸ§  è¡¥å……ï¼škeyof ä¸ in çš„ä½œç”¨

* `keyof T`ï¼šè·å–æŸä¸ªç±»å‹çš„æ‰€æœ‰é”®åç»„æˆçš„è”åˆç±»å‹ã€‚
* `in`ï¼šåœ¨æ˜ å°„ç±»å‹ä¸­ç”¨äºéå†é”®ã€‚

```ts
type Keys = keyof { a: string; b: number }; // "a" | "b"

type Mapped<T> = {
  [K in keyof T]: T[K];
}
```

---

## âœ… æ€»ç»“å¯¹æ¯”

| ç‰¹æ€§     | æ¡ä»¶ç±»å‹                       | æ˜ å°„ç±»å‹                             |
| ------ | -------------------------- | -------------------------------- |
| ç”¨é€”     | ç±»å‹é—´åˆ¤æ–­é€»è¾‘                    | éå†å·²æœ‰ç±»å‹çš„å±æ€§ç”Ÿæˆæ–°ç±»å‹                   |
| å…³é”®è¯­æ³•   | `T extends U ? X : Y`      | `[K in keyof T]: ...`            |
| æ˜¯å¦æ”¯æŒç»„åˆ | âœ…ï¼ˆå¯åµŒå¥—ã€é€’å½’ï¼‰                  | âœ…ï¼ˆå¯åµŒå¥—ã€ç»„åˆæ¡ä»¶ç±»å‹ï¼‰                    |
| åœºæ™¯ç¤ºä¾‹   | ç±»å‹å·¥å…·å¦‚ `Exclude<T, U>`ã€ç±»å‹æ¨æ–­ | å·¥å…·ç±»å‹å¦‚ `Partial<T>`ã€`Readonly<T>` |

---

å¦‚æœä½ æƒ³ï¼Œæˆ‘ä¹Ÿå¯ä»¥æ¼”ç¤ºå¦‚ä½•è‡ªå·±å®ç° `Pick<T, K>` æˆ– `Omit<T, K>` ç­‰å·¥å…·ç±»å‹ã€‚æ˜¯å¦éœ€è¦ï¼Ÿ

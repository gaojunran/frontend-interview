---
title: 什么是 React 的状态提升？使用场景有哪些？
---

当然！我来详细讲讲 **React 的状态提升（State Lifting）**。

---

## 什么是 React 的状态提升？

**状态提升**（英文叫做 **State Lifting**）是指：

> 当多个组件需要共享某些状态时，我们将这些状态从它们各自的子组件中“提升”到它们最近的共同父组件中管理。然后通过 props 将状态和状态更新函数传递给子组件。

换句话说：

* 原本各自管理自己的状态的组件，将需要共享的状态提升到共同的父组件中统一管理。
* 子组件通过 props 获取状态和操作状态的函数，从而实现多个组件之间共享和同步状态。

---

## 为什么要做状态提升？

* React 中数据是单向流动的（从父组件流向子组件）。
* 当多个组件需要共享某个状态，如果状态存在于某个子组件内部，其他组件是无法访问或修改的。
* 因此，必须把这个状态提升到它们的最近公共父组件，由父组件管理并通过 props 传递给需要的子组件。

---

## 举个简单例子

假设有两个兄弟组件，分别控制两个输入框的内容，但它们需要共享输入的值。

```jsx
function Parent() {
  const [value, setValue] = React.useState("");

  return (
    <>
      <ChildA value={value} onChange={setValue} />
      <ChildB value={value} onChange={setValue} />
    </>
  );
}

function ChildA({ value, onChange }) {
  return <input value={value} onChange={e => onChange(e.target.value)} />;
}

function ChildB({ value, onChange }) {
  return <input value={value} onChange={e => onChange(e.target.value)} />;
}
```

这里的状态 `value` 本来可能放在 `ChildA` 或 `ChildB`，但因为两个组件都要用到，就把状态提升到了共同的父组件 `Parent`。

---

## 具体使用场景有哪些？

1. **多个组件需要共享状态时**
   例如表单中多个输入框联动、筛选和展示列表的联动等。

2. **父子组件之间需要协同工作时**
   父组件需要知道子组件的某些状态，或者子组件需要响应父组件状态变化。

3. **避免状态不一致**
   当状态分别存储在不同组件中，会导致状态同步困难，数据不一致。状态提升统一管理状态，保证数据一致。

4. **管理业务逻辑**
   将复杂的业务逻辑放在上层组件，使子组件只负责渲染和简单交互。

---

## 状态提升的优缺点

### 优点：

* 共享状态方便，数据流清晰。
* 状态变更集中管理，更容易维护。
* 避免了状态冗余，减少同步问题。

### 缺点：

* 父组件变得臃肿，承担更多逻辑。
* 组件之间耦合度提高，层级传参较多时可能导致“prop drilling”（属性层层传递）。
* 适用小型共享状态，复杂状态可以考虑用状态管理库（如 Redux、Zustand）或者 Context。

---

## 总结

| 关键点    | 说明                 |
| ------ | ------------------ |
| 状态提升定义 | 将共享状态提升到最近公共父组件管理  |
| 主要目的   | 多个组件共享和同步状态        |
| 使用场景   | 兄弟组件间共享状态，父子组件状态协调 |
| 优点     | 数据同步，管理集中          |
| 缺点     | 组件臃肿，可能导致层层传参      |

---

如果你想，我还可以帮你写一个更具体的示例代码或者说明如何配合 React Context 使用，或者什么时候该考虑状态提升之外的方案，你需要吗？

---
title: 说说真实 DOM 和虚拟 DOM 的区别？它们的优缺点是什么？
---

React 中的 **虚拟 DOM（Virtual DOM）** 和 **真实 DOM（Real DOM）** 是前端开发中非常核心的两个概念。下面我们从定义、区别、优缺点等多个角度详细讲解：

---

## 一、基本概念

### 1. 真实 DOM（Real DOM）

* 浏览器中的原生 DOM 对象。
* 每一个 HTML 元素都是一个 DOM 节点，结构化地表示在浏览器的内存中。
* 可以通过 JavaScript（如 `document.querySelector`, `element.innerHTML`）操作它。
* 直接操作真实 DOM 是**昂贵的**，因为它涉及：

  * 浏览器的重排（reflow）
  * 重绘（repaint）
  * 样式计算和布局

### 2. 虚拟 DOM（Virtual DOM）

* React 使用 JavaScript 对象模拟 DOM 结构，称为虚拟 DOM。
* 它是一个**轻量级的 DOM 树**，用对象树来描述 UI 的结构。
* 每当组件的 state 或 props 发生变化时，React 就会重新生成一棵新的虚拟 DOM，然后将新旧虚拟 DOM 进行 **diff（差异比较）**，最后把变化部分高效地更新到真实 DOM 上。

---

## 二、虚拟 DOM vs 真实 DOM 的区别

| 维度      | 虚拟 DOM                          | 真实 DOM              |
| ------- | ------------------------------- | ------------------- |
| 本质      | JS 对象                           | 浏览器提供的 API 和节点结构    |
| 操作性能    | 快（通过 diff 算法减少 DOM 操作）          | 慢（每次都直接操作 DOM）      |
| 创建/修改方式 | React 自己管理                      | 通过原生 JS / jQuery 操作 |
| 更新策略    | 批量更新（异步）                        | 立即更新（同步）            |
| 跨平台能力   | 强，可用于 Web、Native（React Native）等 | 只能用于 Web 浏览器        |

---

## 三、虚拟 DOM 的优缺点

### ✅ 优点

1. **性能优化**

   * 避免频繁的真实 DOM 操作，通过 diff 算法只更新最小必要部分。
   * 支持 React 的批量更新机制和 Fiber 架构。

2. **跨平台能力强**

   * 虚拟 DOM 不依赖浏览器 DOM API，因此可扩展到移动端（React Native）、桌面端（Electron）等。

3. **可维护性好**

   * 抽象化的 UI 结构，提高代码可读性和组织性。
   * 通过 JSX + 虚拟 DOM 让 UI 状态和视图的映射更直观。

4. **更安全**

   * 避免直接操作真实 DOM，减少 XSS 漏洞风险。

### ❌ 缺点

1. **初始渲染比直接 DOM 慢**

   * 多了一步创建虚拟 DOM 和 diff 的过程。
   * 对于小型应用或一次性渲染，虚拟 DOM 并不一定比直接操作 DOM 快。

2. **额外内存消耗**

   * 虚拟 DOM 本质是 JS 对象，占用内存。
   * 在大量更新、长时间运行的应用中需要注意内存优化。

3. **diff 算法是启发式的，不完美**

   * React 使用的 diff 算法基于一定假设（如 key 唯一性等），如果开发者使用不当，反而可能导致性能下降。

---

## 四、真实 DOM 的优缺点

### ✅ 优点

* **直观、原生**：不需要学习额外抽象，可以直接使用。
* **小项目简单高效**：直接 DOM 操作在简单页面中效率更高。

### ❌ 缺点

* **性能瓶颈严重**：频繁操作 DOM 会导致浏览器反复重排、重绘。
* **可维护性差**：UI 状态和 DOM 紧耦合，代码结构混乱。
* **不适合大型应用**：手动管理更新逻辑复杂且容易出错。

---

## 五、总结

| 项目     | 虚拟 DOM    | 真实 DOM   |
| ------ | --------- | -------- |
| 渲染性能   | 更快（大部分场景） | 较慢（频繁操作） |
| 可维护性   | 高         | 低        |
| 跨平台支持  | 强         | 弱        |
| 内存占用   | 相对高       | 相对低      |
| 初始渲染速度 | 较慢        | 较快       |
| 技术复杂度  | 高（需框架支持）  | 低（直接操作）  |

---

## 六、React 为什么选择虚拟 DOM？

React 的设计目标是构建**复杂应用中可预测、高性能、跨平台的 UI**，使用虚拟 DOM：

* 避免手动更新 DOM 的繁琐逻辑；
* 提供更强的开发体验（组合、抽象、声明式）；
* 通过 diff 算法和 Fiber 架构提供性能保证；
* 可扩展性强，支持 React Native、SSR 等多端渲染。

---

如你需要，我还可以带你手写一个小型的虚拟 DOM 实现 demo，更直观理解它的工作原理。需要吗？

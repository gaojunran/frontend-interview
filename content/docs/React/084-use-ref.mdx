---
title: è¯¦ç»†è®²è®² React ä¸­çš„ useRefï¼Ÿ
---

åœ¨ React ä¸­ï¼Œ`useRef` æ˜¯ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„ Hookï¼Œä¸»è¦ä½œç”¨æ˜¯**åˆ›å»ºå¯å˜çš„å¼•ç”¨å¯¹è±¡ï¼ˆref å¯¹è±¡ï¼‰**ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ã€‚å®ƒçš„å¸¸è§ç”¨é€”æœ‰ï¼š

---

## ğŸ§  ä¸€å¥è¯ç†è§£ï¼š

> `useRef` è¿”å›ä¸€ä¸ªå¯å˜çš„ `.current` å±æ€§å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ï¼Œä¸ä¼šå› ä¸ºç»„ä»¶çš„é‡æ–°æ¸²æŸ“è€Œå˜åŒ–ã€‚

---

## ğŸ“¦ åŸºæœ¬è¯­æ³•ï¼š

```jsx
const myRef = useRef(initialValue);
```

* `myRef.current` æ˜¯å¯è¯»å†™çš„ã€‚
* åˆå§‹å€¼ `initialValue` å¯ä»¥æ˜¯ `null`ã€æŸä¸ª DOM å…ƒç´ ã€æ•°å€¼ã€å¯¹è±¡ç­‰ã€‚

---

## ğŸ§° å¸¸è§ç”¨é€”ï¼š

### âœ… 1. **è®¿é—® DOM å…ƒç´ **

è¿™æ˜¯æœ€å¸¸è§çš„ç”¨æ³•ä¹‹ä¸€ï¼Œç±»ä¼¼äº class ç»„ä»¶ä¸­çš„ `createRef`ã€‚

```jsx
import { useRef, useEffect } from "react";

function InputFocus() {
  const inputRef = useRef(null);

  useEffect(() => {
    inputRef.current.focus(); // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨ focus
  }, []);

  return <input ref={inputRef} />;
}
```

---

### âœ… 2. **åœ¨ render ä¸­ä¿å­˜å¯å˜å˜é‡ï¼Œè€Œä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“**

å¯ä»¥æŠŠ `useRef` å½“æˆ â€œä¸ä¼šè§¦å‘ç»„ä»¶æ›´æ–°çš„ stateâ€ã€‚

```jsx
function Timer() {
  const count = useRef(0);

  const handleClick = () => {
    count.current += 1;
    console.log("ç‚¹å‡»æ¬¡æ•°", count.current);
  };

  return <button onClick={handleClick}>Click me</button>;
}
```

* ä¸ä¼šå› ä¸º `count.current` æ”¹å˜è€Œè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚
* å¯ç”¨äºä¿å­˜**å®šæ—¶å™¨ ID**ã€**ä¸Šæ¬¡çš„ props/state å€¼**ç­‰å‰¯ä½œç”¨å˜é‡ã€‚

---

### âœ… 3. **ä¿æŒä¸Šä¸€æ¬¡çš„ props æˆ– state**

```jsx
function PreviousValue({ value }) {
  const prevValue = useRef();

  useEffect(() => {
    prevValue.current = value;
  }, [value]);

  return (
    <div>
      Now: {value}, Prev: {prevValue.current}
    </div>
  );
}
```

---

### âœ… 4. **é…åˆ `setInterval` ç­‰å‰¯ä½œç”¨æ“ä½œ**

```jsx
function Countdown() {
  const timerRef = useRef();

  useEffect(() => {
    timerRef.current = setInterval(() => {
      console.log("å€’è®¡æ—¶...");
    }, 1000);

    return () => clearInterval(timerRef.current);
  }, []);

  return <div>å€’è®¡æ—¶ä¸­</div>;
}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹ï¼š

1. **æ”¹å˜ `ref.current` ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“**

   * å¦‚æœä½ éœ€è¦æ›´æ–°ç»„ä»¶ï¼Œè¯·ä½¿ç”¨ `useState`ã€‚
2. **æ¯æ¬¡æ¸²æŸ“æ—¶ useRef è¿”å›çš„å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªï¼ˆå¼•ç”¨ç›¸åŒï¼‰**

   * æ‰€ä»¥å®ƒå¯ä»¥è·¨æ¸²æŸ“å­˜å‚¨å€¼ã€‚

---

## ğŸ” useRef vs useState

| ç‰¹æ€§            | `useRef`         | `useState` |
| ------------- | ---------------- | ---------- |
| æ˜¯å¦å¼•èµ·é‡æ–°æ¸²æŸ“      | âŒ ä¸ä¼š             | âœ… ä¼š        |
| æ˜¯å¦è·¨æ¸²æŸ“ä¿æŒå€¼      | âœ… ä¼š              | âœ… ä¼š        |
| æ˜¯å¦é€‚åˆå­˜å‚¨ DOM èŠ‚ç‚¹ | âœ… æ˜¯              | âŒ å¦        |
| å…¸å‹ç”¨é€”          | DOM å¼•ç”¨ã€å‰¯ä½œç”¨å˜é‡ã€ç¼“å­˜å€¼ | æ§åˆ¶ UI çŠ¶æ€   |

---

## ğŸ§ª å°æŠ€å·§ï¼šå¯åšå®ä¾‹ç¼“å­˜

```jsx
const instanceRef = useRef(new SomeClass()); // æ°¸è¿œåªæ„é€ ä¸€æ¬¡
```

---

å¦‚æœä½ å‘Šè¯‰æˆ‘å…·ä½“çš„ä½¿ç”¨åœºæ™¯ï¼ˆå¦‚åŠ¨ç”»ã€è¡¨å•ã€å›¾è¡¨ç­‰ï¼‰ï¼Œæˆ‘å¯ä»¥ç»™ä½ æ›´è´´åˆå®é™…çš„ä¾‹å­ã€‚éœ€è¦å—ï¼Ÿ

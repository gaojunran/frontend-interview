---
title: Redux å¦‚ä½•å®ç°å¤šä¸ªç»„ä»¶ä¹‹é—´çš„é€šä¿¡ï¼Ÿå¤šä¸ªç»„ä»¶ä½¿ç”¨ç›¸åŒçŠ¶æ€æ—¶å¦‚ä½•è¿›è¡Œç®¡ç†ï¼Ÿ
---

åœ¨ React ä¸­ï¼ŒRedux æ˜¯ä¸€ä¸ªç”¨äºçŠ¶æ€ç®¡ç†çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©å¤šä¸ªç»„ä»¶å…±äº«çŠ¶æ€ã€è¿›è¡Œé€šä¿¡ã€‚ä¸‹é¢æˆ‘ä»¬åˆ†ä¸¤éƒ¨åˆ†è¯¦ç»†è®²è®²ï¼š

---

## ä¸€ã€Redux å¦‚ä½•å®ç°å¤šä¸ªç»„ä»¶ä¹‹é—´çš„é€šä¿¡ï¼Ÿ

Redux çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š**å°†ç»„ä»¶çŠ¶æ€æå‡åˆ°å…¨å±€çš„ Redux store ä¸­**ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½å¯ä»¥é€šè¿‡è¿æ¥åˆ°è¿™ä¸ª store æ¥è¯»å†™å…±äº«çŠ¶æ€ã€‚

### é€šä¿¡æµç¨‹

1. **åˆ›å»º Redux Store**ï¼š

   * å…¨å±€å”¯ä¸€çš„çŠ¶æ€å®¹å™¨ï¼Œä¿å­˜æ•´ä¸ªåº”ç”¨çš„çŠ¶æ€æ ‘ã€‚

2. **å®šä¹‰ Action**ï¼š

   * æ™®é€š JS å¯¹è±¡ï¼Œæè¿°â€œå‘ç”Ÿäº†ä»€ä¹ˆâ€ã€‚æ¯”å¦‚ `ADD_TODO`, `SET_USER`ã€‚

3. **å®šä¹‰ Reducer**ï¼š

   * æ ¹æ®å½“å‰çŠ¶æ€å’Œ action è¿”å›æ–°çš„çŠ¶æ€ï¼ˆçº¯å‡½æ•°ï¼‰ã€‚

4. **ç»„ä»¶åˆ†å‘ Actionï¼ˆdispatchï¼‰**ï¼š

   * ä¸€ä¸ªç»„ä»¶é€šè¿‡ `dispatch(action)` æ”¹å˜ store ä¸­çš„çŠ¶æ€ã€‚

5. **å…¶ä»–ç»„ä»¶è®¢é˜…çŠ¶æ€å˜åŒ–ï¼ˆsubscribe/selectï¼‰**ï¼š

   * ä½¿ç”¨ `useSelector` è·å–çŠ¶æ€ï¼Œå½“çŠ¶æ€å˜åŒ–æ—¶è‡ªåŠ¨é‡æ–°æ¸²æŸ“ã€‚

### ä¸¾ä¾‹

å‡è®¾æœ‰ä¸¤ä¸ªç»„ä»¶ `A` å’Œ `B`ï¼Œå®ƒä»¬éƒ½ä½¿ç”¨åŒä¸€ä¸ªå…¨å±€çŠ¶æ€ï¼š

```js
// actions.js
export const setUserName = (name) => ({
  type: 'SET_USER_NAME',
  payload: name
});

// reducer.js
const initialState = { userName: '' };
export default function userReducer(state = initialState, action) {
  switch (action.type) {
    case 'SET_USER_NAME':
      return { ...state, userName: action.payload };
    default:
      return state;
  }
}
```

```js
// store.js
import { createStore } from 'redux';
import userReducer from './reducer';
export const store = createStore(userReducer);
```

```js
// App.js
import { Provider } from 'react-redux';
import { store } from './store';
<Provider store={store}>
  <ComponentA />
  <ComponentB />
</Provider>
```

```js
// ComponentA.jsx
import { useDispatch } from 'react-redux';
import { setUserName } from './actions';
function ComponentA() {
  const dispatch = useDispatch();
  return <button onClick={() => dispatch(setUserName("Alice"))}>Set User</button>;
}
```

```js
// ComponentB.jsx
import { useSelector } from 'react-redux';
function ComponentB() {
  const name = useSelector((state) => state.userName);
  return <p>User: {name}</p>;
}
```

å½“ `ComponentA` ä¸­ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œ`ComponentB` ä¼šè‡ªåŠ¨æ›´æ–°æ˜¾ç¤ºï¼Œå› ä¸ºå®ƒè®¢é˜…äº† Redux store ä¸­çš„çŠ¶æ€ã€‚

---

## äºŒã€å¤šä¸ªç»„ä»¶ä½¿ç”¨ç›¸åŒçŠ¶æ€æ—¶å¦‚ä½•ç®¡ç†ï¼Ÿ

### æ ¸å¿ƒåŸåˆ™ï¼š**é›†ä¸­ç®¡ç† + æ‹†åˆ† reducer + æŒ‰éœ€è®¢é˜…**

1. **é›†ä¸­ç®¡ç†**ï¼š

   * æ‰€æœ‰å…±äº«çŠ¶æ€æ”¾åˆ° Redux çš„ Store ä¸­ï¼ˆä¾‹å¦‚ç”¨æˆ·ä¿¡æ¯ã€ä¸»é¢˜ã€æƒé™ã€è¯­è¨€ç­‰ï¼‰ã€‚

2. **æ¨¡å—åŒ– Reducerï¼ˆä½¿ç”¨ combineReducersï¼‰**ï¼š

   * å¯ä»¥å°†ä¸åŒåŠŸèƒ½çš„çŠ¶æ€æ‹†åˆ†ç®¡ç†ï¼Œä¾‹å¦‚ï¼š

```js
const rootReducer = combineReducers({
  user: userReducer,
  theme: themeReducer,
  settings: settingsReducer
});
```

3. **ç»„ä»¶æŒ‰éœ€é€‰æ‹©çŠ¶æ€ï¼ˆuseSelectorï¼‰**ï¼š

   * æ¯ä¸ªç»„ä»¶åªé€‰è‡ªå·±éœ€è¦çš„çŠ¶æ€ç‰‡æ®µï¼Œé¿å…ä¸å¿…è¦çš„æ¸²æŸ“ã€‚

```js
const username = useSelector((state) => state.user.name);
const theme = useSelector((state) => state.theme.color);
```

4. **é¿å…è¿‡åº¦å…±äº«**ï¼š

   * ä¸€äº›åªç”¨äºå±€éƒ¨çš„çŠ¶æ€å¯ä»¥ä½¿ç”¨ `useState` æˆ– `useReducer` æœ¬åœ°ç®¡ç†ã€‚

5. **ä½¿ç”¨ Redux Toolkit ç®€åŒ–**ï¼ˆæ¨èï¼‰ï¼š

   * Redux Toolkit æä¾› `createSlice`ï¼Œæå¤§ç®€åŒ–äº† reducer å’Œ action çš„ç¼–å†™ã€‚

---

## ä¸‰ã€æ€»ç»“

| åœºæ™¯     | ä¼ ç»Ÿç»„ä»¶é€šä¿¡æ–¹å¼            | Redux æ–¹å¼                |
| ------ | ------------------- | ----------------------- |
| çˆ¶å­é€šä¿¡   | props ä¼ é€’            | useSelector/useDispatch |
| å…„å¼Ÿç»„ä»¶é€šä¿¡ | æå‡çŠ¶æ€æˆ– context       | å…±ç”¨ Redux store          |
| è·¨å±‚ç»„ä»¶é€šä¿¡ | context æˆ– event bus | å…¨å±€çŠ¶æ€ç®¡ç†                  |

Redux æä¾›çš„æ˜¯\*\*â€œå…¨å±€çŠ¶æ€å…±äº« + è®¢é˜…å‘å¸ƒæœºåˆ¶â€\*\*ï¼Œä½¿å¾—å¤šä¸ªç»„ä»¶å¯ä»¥é€šè¿‡åŒä¸€ä¸ª store å®ç°é€šä¿¡ï¼Œé¿å… props ä¸€å±‚å±‚ä¼ é€’çš„å¤æ‚æ€§ï¼Œå°¤å…¶é€‚åˆä¸­å¤§å‹é¡¹ç›®ã€‚

---

Zustand æ˜¯ä¸€ä¸ªè½»é‡çº§ã€ç®€å•æ˜“ç”¨çš„ React çŠ¶æ€ç®¡ç†åº“ï¼Œç”¨äºæ›¿ä»£ Reduxï¼Œæ”¯æŒå±€éƒ¨æ›´æ–°ã€æ— æ ·æ¿ä»£ç ï¼Œä¸”æ— éœ€ Providerã€‚å®ƒçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ª**å…¨å±€çš„çŠ¶æ€ store**ï¼Œä½¿ç”¨éå¸¸çµæ´»ï¼Œé€‚åˆä¸­å°å‹åº”ç”¨ï¼Œä¹Ÿå¯ä»¥æ”¯æŒå¤§å‹é¡¹ç›®ã€‚

---

## ğŸ§  ä¸€å¥è¯ç†è§£ Zustand

> â€œZustand é€šè¿‡åˆ›å»ºå…¨å±€ storeï¼Œè®©å¤šä¸ªç»„ä»¶å…±äº«çŠ¶æ€ï¼Œå°±åƒä½¿ç”¨ `useState` ä¸€æ ·ç®€å•ã€‚â€

---

## âœ… åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹ï¼ˆå¤šä¸ªç»„ä»¶é€šä¿¡ï¼‰

å‡è®¾ä½ æœ‰ä¸¤ä¸ªç»„ä»¶ A å’Œ Bï¼Œéƒ½è¦å…±äº« `userName` è¿™ä¸ªçŠ¶æ€ï¼š

### 1. å®‰è£…

```bash
npm install zustand
```

---

### 2. åˆ›å»ºçŠ¶æ€ storeï¼ˆstore.jsï¼‰

```js
// store.js
import { create } from 'zustand';

export const useUserStore = create((set) => ({
  userName: '',
  setUserName: (name) => set({ userName: name })
}));
```

---

### 3. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

#### âœ… ComponentA.jsxï¼ˆä¿®æ”¹çŠ¶æ€ï¼‰

```js
import { useUserStore } from './store';

function ComponentA() {
  const setUserName = useUserStore((state) => state.setUserName);

  return <button onClick={() => setUserName('Alice')}>è®¾ç½®ç”¨æˆ·å</button>;
}
```

#### âœ… ComponentB.jsxï¼ˆè¯»å–çŠ¶æ€ï¼‰

```js
import { useUserStore } from './store';

function ComponentB() {
  const userName = useUserStore((state) => state.userName);

  return <p>ç”¨æˆ·åæ˜¯ï¼š{userName}</p>;
}
```

âœ”ï¸ å½“ä½ ç‚¹å‡» A ä¸­æŒ‰é’®æ—¶ï¼ŒB ä¼šè‡ªåŠ¨æ›´æ–°ã€‚

---

## ğŸ¯ ä¼˜åŠ¿å¯¹æ¯” Redux

| ç‰¹æ€§            | Redux                | Zustand        |
| ------------- | -------------------- | -------------- |
| æ˜¯å¦éœ€è¦ Provider | âœ… éœ€è¦ `<Provider>` åŒ…è£¹ | âŒ ä¸éœ€è¦          |
| å†™æ³•            | æ¨¡æ¿å¤šï¼Œå†—é•¿               | ç®€æ´ï¼Œå‡½æ•°å¼         |
| çŠ¶æ€æ¨¡å—åŒ–         | `combineReducers`    | å¤šä¸ª store æˆ–é€»è¾‘åˆ‡ç‰‡ |
| ä½¿ç”¨éš¾åº¦          | ä¸­                    | éå¸¸ç®€å•           |
| æ”¯æŒå¼‚æ­¥          | éœ€è¦ä¸­é—´ä»¶                | ç›´æ¥å†™ async å‡½æ•°   |

---

## ğŸ§© å¤šçŠ¶æ€ç®¡ç†ï¼ˆå¯é€‰æ‰©å±•ï¼‰

ä½ å¯ä»¥å°†å¤šä¸ªçŠ¶æ€æ”¾ä¸€èµ·ï¼Œä¹Ÿå¯ä»¥æ‹†åˆ†å¤šä¸ª store æ–‡ä»¶ã€‚

```js
// store/useUserStore.js
export const useUserStore = create((set) => ({
  userName: '',
  setUserName: (name) => set({ userName: name })
}));

// store/useThemeStore.js
export const useThemeStore = create((set) => ({
  theme: 'light',
  toggleTheme: () => set((state) => ({
    theme: state.theme === 'light' ? 'dark' : 'light'
  }))
}));
```

ç„¶ååœ¨ç»„ä»¶ä¸­æŒ‰éœ€ä½¿ç”¨æŸä¸ª storeï¼Œ**äº’ä¸å½±å“**ã€‚

---

## ğŸ›  è¿›é˜¶åŠŸèƒ½ï¼ˆç®€è¦åˆ—ä¸¾ï¼‰

* âœ… æ”¯æŒä¸­é—´ä»¶ï¼ˆæŒä¹…åŒ–ã€devtoolsï¼‰
* âœ… æ”¯æŒå¼‚æ­¥ action
* âœ… æ”¯æŒé€‰æ‹©å™¨ï¼ˆé¿å…ç»„ä»¶è¿‡åº¦æ›´æ–°ï¼‰
* âœ… æ”¯æŒ immerï¼ˆå¯ç›´æ¥ä¿®æ”¹çŠ¶æ€ï¼‰

```js
import { create } from 'zustand';
import { persist, devtools } from 'zustand/middleware';

export const useStore = create(
  devtools(
    persist(
      (set) => ({
        count: 0,
        inc: () => set((state) => ({ count: state.count + 1 }))
      }),
      { name: 'my-storage' }
    )
  )
);
```

---

## âœ… æ€»ç»“

Zustand éå¸¸é€‚åˆä½ å¦‚æœï¼š

* æƒ³è¦ç®€å•åœ°å…±äº«çŠ¶æ€ï¼ˆæ— éœ€æ ·æ¿ä»£ç ï¼‰
* ä¸æƒ³å¼•å…¥ Redux çš„å¤æ‚å·¥å…·é“¾
* å–œæ¬¢å‡½æ•°å¼å’Œç®€æ´ä»£ç é£æ ¼


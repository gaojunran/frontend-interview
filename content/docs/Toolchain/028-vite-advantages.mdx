---
title: 	pnpm 相比于其他的包管理工具有什么优势？
---

当然，关于 **pnpm** 相比其他包管理工具（如 npm、Yarn）有哪些优势，我可以详细讲讲。pnpm 作为一个现代的包管理器，近年来越来越受欢迎，主要是因为它在性能、磁盘空间利用、安装一致性等方面做得非常好。

---

## 1. 高效的磁盘空间利用（硬链接和内容寻址存储）

* **传统的 npm 和 Yarn（尤其是 Yarn v1）**，每个项目都会把依赖安装到项目的 `node_modules` 目录里，且每个依赖都会复制一份完整的文件。
* **pnpm 的设计不同**，它使用了全局内容寻址存储（类似于 Git 的对象存储）：

  * 所有下载的包只会存储一份在全局缓存目录（通常是用户目录下的 `.pnpm-store`）。
  * 每个项目的 `node_modules` 会通过 **硬链接（hard link）** 或者符号链接指向全局缓存的包文件，而不是复制文件。
  * 这样可以极大节省磁盘空间，尤其是多个项目依赖相同包时。

**总结：pnpm 能减少磁盘空间的占用，且安装速度更快，因为不需要重复复制文件。**

---

## 2. 严格且一致的依赖树结构（避免“幽灵依赖”）

* 传统 npm 或 Yarn 会在安装时将依赖“扁平化”，导致可能出现依赖缺失问题（某些包隐式依赖了父依赖的包，出现“幽灵依赖”问题）。
* **pnpm 采用严格的节点模块结构**：

  * 依赖的依赖必须显式声明在 `package.json` 中。
  * 每个依赖都会被隔离，不会随意“冒泡”到项目根目录，确保模块解析严格按照依赖关系。
* 这使得项目依赖更加清晰，避免了运行时因依赖缺失产生的隐晦错误。

---

## 3. 快速安装和增量安装

* pnpm 利用了缓存和硬链接，下载后的包不重复下载。
* 对于已经安装过的依赖，pnpm 只会做最小的变动，进行增量安装。
* 这使得它在多项目开发中，可以显著加快安装速度。

---

## 4. 支持 Monorepo 和 Workspaces 友好

* pnpm 原生支持 Monorepo，且在工作区（workspace）管理上有显著优势：

  * 可以跨包共享依赖。
  * 利用符号链接方便多个包间的依赖管理和本地联调。
* pnpm workspace 的设计让大型项目结构更清晰，安装依赖更高效。

---

## 5. 安装的确定性和锁文件稳定性

* pnpm 保证锁文件（`pnpm-lock.yaml`）的确定性，安装结果一致。
* 其严格的依赖树结构减少了不确定性和“安装环境”差异带来的问题。
* 这对 CI/CD、团队协作非常重要，确保所有人安装环境一致。

---

## 6. 支持各种平台和 Node 版本

* pnpm 兼容性好，支持各种 Node.js 版本。
* 同时支持 Windows、Linux、macOS。

---

## 7. 生态支持和迁移方便

* pnpm 和 npm 使用的是相同的 `package.json` 和 npm registry。
* 你可以很方便地从 npm 或 Yarn 切换到 pnpm，无需修改项目配置。
* 也支持 npm/yarn 的命令行大部分选项，学习成本低。

---

## 8. 社区活跃和持续优化

* pnpm 团队持续优化，新增性能提升特性。
* 比如最新版本中，改进了缓存策略、支持部分并行安装等。

---

# 总结对比表

| 特性          | npm         | Yarn (v1/v2) | pnpm            |
| ----------- | ----------- | ------------ | --------------- |
| 磁盘空间占用      | 每项目复制一份依赖   | 类似 npm       | 全局内容寻址+硬链接，节省空间 |
| 依赖树结构       | 扁平化，可能有幽灵依赖 | Yarn v2 改进了  | 严格隔离，避免幽灵依赖     |
| 安装速度        | 中等          | 较快           | 快（增量安装+缓存硬链接）   |
| Monorepo 支持 | 基础          | 支持较好         | 原生支持，优化工作区依赖管理  |
| 锁文件稳定性      | 稳定          | 稳定           | 更加确定性和严格        |
| 兼容性         | 最广          | 较好           | 兼容性良好，支持各种环境    |

---

如果你需要，我可以帮你分析在实际项目中，pnpm 具体的配置、切换方案和最佳实践。你觉得呢？


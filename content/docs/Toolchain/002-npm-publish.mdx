---
title: 	å¦‚ä½•é€šè¿‡ npm å‘å¸ƒå‰ç«¯ packageï¼Ÿå‘å¸ƒæµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ
---

é€šè¿‡ `npm` å‘å¸ƒå‰ç«¯åŒ…ï¼ˆå¦‚ç»„ä»¶åº“ã€å·¥å…·åº“ç­‰ï¼‰ï¼Œå¯ä»¥è®©å…¶ä»–äººé€šè¿‡ `npm install` ç›´æ¥ä½¿ç”¨ä½ çš„åŒ…ã€‚ä¸‹é¢æ˜¯å®Œæ•´çš„å‘å¸ƒæµç¨‹ï¼Œä»å‡†å¤‡åˆ°å‘å¸ƒï¼Œæ¯ä¸€æ­¥è¯¦ç»†è®²è§£ã€‚

---

## ğŸ§¾ ä¸€ã€å‡†å¤‡å·¥ä½œ

### 1. æ³¨å†Œå¹¶ç™»å½• npm è´¦å·

å…ˆç¡®ä¿ä½ æœ‰ npm è´¦å·ï¼š

```bash
npm login
```

å¦‚æœæ²¡æœ‰è´¦å·ï¼Œå…ˆå»å®˜ç½‘æ³¨å†Œï¼š[https://www.npmjs.com/signup](https://www.npmjs.com/signup)

ç™»å½•æ—¶éœ€è¦è¾“å…¥ï¼š

* Username
* Password
* Email

ç™»å½•æˆåŠŸåï¼Œä½ çš„è®¤è¯ä¿¡æ¯ä¼šè¢«ä¿å­˜åœ¨æœ¬åœ°ï¼ˆ`~/.npmrc` æ–‡ä»¶ä¸­ï¼‰ã€‚

---

### 2. åˆå§‹åŒ–é¡¹ç›®

åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š

```bash
npm init
```

æˆ–è€…å¿«é€Ÿåˆå§‹åŒ–ï¼š

```bash
npm init -y
```

ä¼šç”Ÿæˆä¸€ä¸ª `package.json` æ–‡ä»¶ï¼Œéœ€ç¡®ä¿ä»¥ä¸‹å­—æ®µè®¾ç½®åˆç†ï¼š

| å­—æ®µ        | æè¿°                                            |
| --------- | --------------------------------------------- |
| `name`    | åŒ…åï¼Œ**å…¨å±€å”¯ä¸€**ï¼Œä¸èƒ½å’Œå·²æœ‰çš„é‡å¤ï¼ˆå¯ç”¨ `@scope/name` å‘½åç©ºé—´æ–¹å¼ï¼‰ |
| `version` | å½“å‰ç‰ˆæœ¬å·ï¼Œåˆæ¬¡ä¸º `1.0.0`ï¼ˆéµå¾ª semverï¼‰                  |
| `main`    | å…¥å£æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼š`dist/index.js`ï¼‰                      |
| `files`   | æŒ‡å®šå‘å¸ƒå“ªäº›æ–‡ä»¶ï¼Œå‡å°‘åŒ…ä½“ç§¯ï¼ˆå¦‚ `["dist"]`ï¼‰                  |
| `scripts` | å¯åŠ å…¥ `build` å‘½ä»¤ï¼š`"build": "vite build"`        |

---

### 3. ç¼–è¯‘ä½ çš„ä»£ç 

ä½¿ç”¨æ„å»ºå·¥å…·ï¼ˆå¦‚ Viteã€Webpackã€Rollupï¼‰æ‰“åŒ…ä¸ºé€‚åˆå‘å¸ƒçš„æ ¼å¼ï¼š

å¸¸è§æ ¼å¼ï¼š

* CommonJSï¼ˆNodeï¼‰
* ESMï¼ˆç°ä»£å‰ç«¯ï¼‰
* UMDï¼ˆæµè§ˆå™¨é€šç”¨ï¼‰

ä¾‹å¦‚ä½¿ç”¨ Rollup çš„é…ç½®å¯ä»¥æ‰“åŒ…æˆå¤šç§æ ¼å¼ã€‚

ç¤ºä¾‹ï¼š

```ts
// vite.config.ts
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'

export default defineConfig({
  plugins: [vue()],
  build: {
    lib: {
      entry: resolve(__dirname, 'src/index.ts'),
      name: 'MyLib',
      fileName: (format) => `my-lib.${format}.js`,
    },
    rollupOptions: {
      external: ['vue'], // å¤–éƒ¨ä¾èµ–ï¼Œä¸æ‰“åŒ…è¿›è¾“å‡ºæ–‡ä»¶
      output: {
        globals: {
          vue: 'Vue'
        }
      }
    }
  }
})
```

---

### 4. æ·»åŠ  `.npmignore` æˆ– `files`

æ§åˆ¶å‘å¸ƒå†…å®¹ï¼š

* `.npmignore` ä½œç”¨ç±»ä¼¼ `.gitignore`ï¼Œå¿½ç•¥æŸäº›æ–‡ä»¶å‘å¸ƒ
* æ¨èä½¿ç”¨ `package.json` ä¸­çš„ `files` å­—æ®µæ›´æ˜ç¡®

ä¾‹å¦‚ï¼š

```json
"files": [
  "dist",
  "README.md"
]
```

---

## ğŸš€ äºŒã€å‘å¸ƒæµç¨‹

### 1. æ„å»ºé¡¹ç›®

æ‰§è¡Œæ‰“åŒ…å‘½ä»¤ï¼š

```bash
npm run build
```

ç”Ÿæˆ `dist/` ç›®å½•ç­‰æ„å»ºäº§ç‰©ã€‚

---

### 2. å‘å¸ƒåˆ° npm

åœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼š

```bash
npm publish
```

å¦‚æœæ˜¯ scoped packageï¼ˆå¦‚ `@nebula/my-lib`ï¼‰ï¼Œé»˜è®¤æ˜¯ç§æœ‰åŒ…ï¼Œéœ€æ·»åŠ  `--access public`ï¼š

```bash
npm publish --access public
```

---

### 3. éªŒè¯å‘å¸ƒ

å‘å¸ƒåå¯ä»¥å» npm å®˜ç½‘æŸ¥çœ‹ä½ çš„åŒ…ï¼š[https://www.npmjs.com/package/your-package-name](https://www.npmjs.com/package/your-package-name)

ä¹Ÿå¯ä»¥å°è¯•å®‰è£…æµ‹è¯•ï¼š

```bash
npm install your-package-name
```

---

## ğŸ› ï¸ ä¸‰ã€ç‰ˆæœ¬ç®¡ç†ä¸æ›´æ–°

### ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬å·ï¼ˆSemVerï¼‰ï¼š

æ ¼å¼ï¼š`MAJOR.MINOR.PATCH`

* `MAJOR`ï¼šç ´åæ€§æ”¹åŠ¨ï¼ˆå¦‚ API æ”¹åŠ¨ï¼‰
* `MINOR`ï¼šæ–°å¢åŠŸèƒ½ï¼Œå…¼å®¹æ—§ç‰ˆ
* `PATCH`ï¼šä¿®å¤ bugï¼Œå°å¹…æ›´æ–°

æ›´æ–°ç‰ˆæœ¬åå†å‘å¸ƒï¼š

```bash
npm version patch      # 1.0.0 -> 1.0.1
npm version minor      # 1.0.0 -> 1.1.0
npm version major      # 1.0.0 -> 2.0.0

npm publish
```

---

## ğŸ“¦ å››ã€å¸¸è§é—®é¢˜

| é—®é¢˜                                   | è§£å†³åŠæ³•                                  |
| ------------------------------------ | ------------------------------------- |
| å‘å¸ƒå¤±è´¥ï¼Œæç¤ºâ€œpackage name already existsâ€ | æ¢ä¸€ä¸ªå”¯ä¸€åŒ…åæˆ–ä½¿ç”¨ scoped åŒ…åå¦‚ `@yourname/pkg` |
| æ— æ³•å‘å¸ƒï¼Œæç¤ºæ— æƒé™                           | æ£€æŸ¥ä½ æ˜¯å¦ç™»å½•äº†æ­£ç¡®çš„ npm è´¦å·                    |
| é»˜è®¤å‘å¸ƒä¸ºç§æœ‰                              | scoped åŒ…éœ€è¦åŠ  `--access public`         |
| å‘å¸ƒååˆ«äººä¸èƒ½ç”¨                             | æ£€æŸ¥ `main/module` å­—æ®µæ˜¯å¦æ­£ç¡®æŒ‡å‘æ‰“åŒ…åçš„æ–‡ä»¶       |

---

## ğŸ§© äº”ã€å»ºè®®é…ç½®ï¼ˆç¤ºä¾‹ï¼‰

```json
{
  "name": "@nebula/my-lib",
  "version": "1.0.0",
  "main": "dist/index.cjs.js",
  "module": "dist/index.esm.js",
  "files": ["dist"],
  "scripts": {
    "build": "rollup -c"
  },
  "keywords": ["vue", "component", "ui"],
  "author": "Nebula",
  "license": "MIT"
}
```

---


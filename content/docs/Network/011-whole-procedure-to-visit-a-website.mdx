---
title: 说说地址栏输入 URL 敲下回车后发生了什么?
---

当你在浏览器地址栏输入一个 URL（如 `https://www.example.com`）并敲下回车后，浏览器会启动一系列复杂的流程，涉及网络、操作系统、浏览器、服务器等多个层面。我们来逐步详细讲解这个过程：

---

## 🌐 一、URL 解析

用户输入 URL 后，浏览器会解析 URL 的结构：

```
https://www.example.com:443/path?query=123#fragment
│       │             │    │       │
│       │             │    │       └─ Fragment（锚点，不发送给服务器）
│       │             │    └───────── 查询参数
│       │             └───────────── 路径
│       └─────────────────────────── 主机名 + 端口（可省略）
└─────────────────────────────────── 协议（scheme）
```

---

## 🧭 二、浏览器检查本地缓存

浏览器会在以下缓存中查找是否有该资源：

1. **Service Worker 缓存**
2. **Memory Cache**（内存缓存）
3. **Disk Cache**（硬盘缓存）
4. **HTTP 缓存策略**（`Cache-Control`, `ETag`, `Last-Modified` 等）

如果缓存可用并满足条件，直接返回结果，跳过后续步骤。

---

## 🌐 三、DNS 解析（域名解析）

浏览器通过 **DNS 协议** 将 `www.example.com` 解析成 IP 地址（如 `93.184.216.34`）：

1. 浏览器缓存
2. 操作系统缓存（如 `/etc/hosts`）
3. 本地 DNS 服务器缓存
4. 递归查询上级 DNS（根域 → 顶级域 → 权威域）

🔁 如果你在阿里云买了域名，还需要配置 DNS 解析记录，将域名映射到你的服务器 IP。

---

## 🔐 四、建立连接（TCP / TLS）

假设是 HTTPS：

### 1. TCP 三次握手（建立连接）

浏览器与服务器通过 **TCP 协议** 建立连接：

* 客户端：发送 SYN
* 服务端：回应 SYN + ACK
* 客户端：回应 ACK

### 2. TLS 握手（HTTPS 加密）

建立加密通道，过程包括：

* 协议版本协商
* 交换证书（如服务器的 HTTPS 证书）
* 生成对称密钥（通过非对称加密方式）
* 验证服务器身份（浏览器验证证书）

💡 最终形成一个 **安全加密通道**。

---

## 📡 五、浏览器发送 HTTP 请求

加密后，浏览器发送正式的 HTTP 请求，例如：

```
GET /path?query=123 HTTP/1.1
Host: www.example.com
User-Agent: Mozilla/5.0 ...
Cookie: sessionId=xxx
...
```

---

## 🖥️ 六、服务器处理请求

服务器处理步骤：

1. 路由匹配（如 `/path` 匹配哪个处理函数）
2. 权限验证（如登录态）
3. 查询数据库、调用业务逻辑
4. 生成 HTML、JSON、图片等内容
5. 返回 HTTP 响应

示例响应：

```http
HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 1024
Cache-Control: no-cache
...

<html>...</html>
```

---

## 📥 七、浏览器接收响应

浏览器解析 HTTP 响应内容，根据响应头执行动作：

* 如果是 HTML，会继续发送请求下载资源（JS/CSS/图片等）
* 如果是重定向（如 `302`），会自动跳转到新地址
* 如果是错误（如 `404`, `500`），显示错误页面

---

## 🖼️ 八、渲染页面（浏览器渲染引擎）

浏览器执行以下步骤：

1. **解析 HTML**，构建 DOM 树
2. **下载并解析 CSS**，构建 CSSOM
3. **构建 Render Tree**
4. **布局（Layout）**：计算每个元素的位置和大小
5. **绘制（Paint）**：绘制像素信息
6. **合成（Compositing）**：生成最终页面

过程中会执行 JS、发起更多异步请求（AJAX）、应用样式等。

---

## 📌 总结流程图

```text
输入 URL
  ↓
解析 URL
  ↓
查缓存 → 命中？→ 返回资源
  ↓（未命中）
DNS 解析
  ↓
TCP + TLS 建立连接
  ↓
发送 HTTP 请求
  ↓
服务器响应
  ↓
浏览器处理响应内容
  ↓
渲染页面
```

---

## 🔁 补充：

* 有些站点还会进行 **CDN 加速**（内容分发网络）
* JS 加载后可能会执行前端路由（SPA）
* 浏览器有 **预解析、预连接** 优化机制


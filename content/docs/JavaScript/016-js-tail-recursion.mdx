---
title: ä¸¾ä¾‹è¯´æ˜ä½ å¯¹å°¾é€’å½’çš„ç†è§£ï¼Œæœ‰å“ªäº›åº”ç”¨åœºæ™¯
---

å°¾é€’å½’ï¼ˆ**Tail Recursion**ï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šå½¢å¼çš„é€’å½’ï¼Œåœ¨è¿™ç§é€’å½’ä¸­ï¼Œ**å‡½æ•°çš„æœ€åä¸€æ­¥æ˜¯è¿”å›å¦ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨ç»“æœ**ï¼Œå¹¶ä¸”**æ²¡æœ‰å…¶ä»–æ“ä½œéœ€è¦åœ¨è¯¥å‡½æ•°è¿”å›åç»§ç»­è¿›è¡Œ**ã€‚

åœ¨æ”¯æŒå°¾è°ƒç”¨ä¼˜åŒ–ï¼ˆ**Tail Call Optimizationï¼ŒTCO**ï¼‰çš„è¯­è¨€ä¸­ï¼Œå°¾é€’å½’å¯ä»¥é¿å…å‡½æ•°è°ƒç”¨æ ˆçš„å¢é•¿ï¼Œä»è€Œé˜²æ­¢æ ˆæº¢å‡ºï¼Œæé«˜æ€§èƒ½ã€‚

---

### âœ… ä¸€ã€å°¾é€’å½’çš„å®šä¹‰å’Œç‰¹å¾

**å°¾é€’å½’çš„å®šä¹‰ï¼š**

* å½“å‰å‡½æ•°è°ƒç”¨è‡ªèº«æ—¶ï¼Œæ˜¯åœ¨å‡½æ•°çš„æœ€åä¸€æ­¥ï¼ˆå°¾éƒ¨ï¼‰ï¼Œå¹¶ä¸”è°ƒç”¨è¿”å›å€¼ä¼šç›´æ¥ä½œä¸ºç»“æœè¿”å›ã€‚

**ç¤ºä¾‹ï¼šæ™®é€šé€’å½’ vs å°¾é€’å½’ï¼š**

ğŸ‘‰ æ™®é€šé€’å½’ï¼ˆéå°¾é€’å½’ï¼‰ï¼š

```js
function factorial(n) {
  if (n === 1) return 1;
  return n * factorial(n - 1); // ä¹˜æ³•åœ¨é€’å½’è°ƒç”¨ä¹‹åè¿›è¡Œï¼Œéå°¾é€’å½’
}
```

ğŸ‘‰ å°¾é€’å½’ï¼ˆä¼˜åŒ–å†™æ³•ï¼‰ï¼š

```js
function factorial(n, acc = 1) {
  if (n === 1) return acc;
  return factorial(n - 1, acc * n); // é€’å½’è°ƒç”¨æ˜¯å‡½æ•°çš„æœ€åä¸€æ­¥
}
```

---

### âœ… äºŒã€å°¾é€’å½’çš„å¥½å¤„

* é¿å…**è°ƒç”¨æ ˆæº¢å‡º**ï¼ˆåœ¨è¯­è¨€æ”¯æŒ TCO çš„å‰æä¸‹ï¼‰
* æ›´èŠ‚çœå†…å­˜ç©ºé—´
* å¯è¢«ä¼˜åŒ–æˆè¿­ä»£å½¢å¼æ‰§è¡Œï¼ˆæ€§èƒ½æ¥è¿‘å¾ªç¯ï¼‰

> âš ï¸ æ³¨æ„ï¼šJavaScriptï¼ˆç›®å‰å¤§å¤šæ•°å¼•æ“ï¼Œå¦‚ V8ï¼‰**å¹¶ä¸çœŸæ­£æ”¯æŒå°¾è°ƒç”¨ä¼˜åŒ–**ï¼Œå°½ç®¡ç†è®ºä¸Š ES6 æ ‡å‡†ä¸­æåˆ°äº†å®ƒã€‚å› æ­¤å°¾é€’å½’åœ¨ JS ä¸­**ä¸»è¦æ˜¯æ¦‚å¿µæ€§ä¼˜åŒ–æˆ–ä»£ç é£æ ¼ä¼˜åŒ–**ã€‚

---

### âœ… ä¸‰ã€åº”ç”¨åœºæ™¯ä¸¾ä¾‹ï¼ˆJavaScriptï¼‰

#### 1. **æ±‚é˜¶ä¹˜**

```js
function factorial(n, acc = 1) {
  if (n === 1) return acc;
  return factorial(n - 1, acc * n);
}
console.log(factorial(5)); // è¾“å‡º 120
```

#### 2. **æ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—ç¬¬ n é¡¹**

```js
function fib(n, a = 0, b = 1) {
  if (n === 0) return a;
  return fib(n - 1, b, a + b);
}
console.log(fib(10)); // è¾“å‡º 55
```

#### 3. **æ•°ç»„æ±‚å’Œ**

```js
function sum(arr, acc = 0) {
  if (arr.length === 0) return acc;
  return sum(arr.slice(1), acc + arr[0]);
}
console.log(sum([1, 2, 3, 4])); // è¾“å‡º 10
```

#### 4. **æ•°ç»„åè½¬**

```js
function reverse(arr, result = []) {
  if (arr.length === 0) return result;
  result.unshift(arr[0]);
  return reverse(arr.slice(1), result);
}
console.log(reverse([1, 2, 3])); // è¾“å‡º [3, 2, 1]
```

---

### âœ… å››ã€å¦‚ä½•ç”¨å°¾é€’å½’æ›¿ä»£å¾ªç¯ï¼Ÿ

**æ™®é€šå¾ªç¯ç‰ˆæ±‚å’Œï¼š**

```js
function sum(arr) {
  let acc = 0;
  for (let i = 0; i < arr.length; i++) {
    acc += arr[i];
  }
  return acc;
}
```

**å°¾é€’å½’æ¨¡æ‹Ÿè¿­ä»£ï¼š**

```js
function sum(arr, acc = 0) {
  if (arr.length === 0) return acc;
  return sum(arr.slice(1), acc + arr[0]);
}
```

è™½ç„¶å¯è¯»æ€§è¾ƒå¥½ï¼Œä½†åœ¨ä¸æ”¯æŒ TCO çš„ JS å¼•æ“ä¸­æ€§èƒ½ä¼šæ›´å·®ï¼Œè¿˜å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºã€‚

---

### âœ… äº”ã€å°ç»“

| ç‰¹ç‚¹        | æè¿°                              |
| --------- | ------------------------------- |
| ä½ç½®        | é€’å½’è°ƒç”¨å¿…é¡»æ˜¯å‡½æ•°çš„æœ€åä¸€æ­¥                  |
| å¥½å¤„        | ç†è®ºä¸Šå¯ä»¥ä¼˜åŒ–ä¸ºå¾ªç¯ï¼ŒèŠ‚çœæ ˆç©ºé—´                |
| åœ¨ JS ä¸­çš„ç°å® | ES6 æ”¯æŒè¯­æ³•ï¼Œä½†å¤§å¤šæ•° JS å¼•æ“ **æœªå®ç° TCO** |
| æ¨èä½¿ç”¨åœºæ™¯    | æ•°æ®è½¬æ¢ã€è¿­ä»£æ¨¡æ‹Ÿã€å°¾éƒ¨å½’çº¦æ“ä½œï¼ˆå¦‚æ±‚å’Œã€ç§¯ç­‰ï¼‰        |
| å®é™…å»ºè®®      | å°¾é€’å½’ç†è§£é‡è¦ï¼Œä½†åœ¨ JS ä¸­å»ºè®®ä¼˜å…ˆç”¨å¾ªç¯æ¥é¿å…æ ˆæº¢å‡ºé—®é¢˜  |

---


